---
phase: 16-mss-dashboard-reporting
plan: 01
type: execute
---

<objective>
Build MSS Dashboard & Reporting page to view work items grouped by service line with effort summaries and coverage metrics.

Purpose: Provide visibility into how epics and stories are distributed across the MSS taxonomy, enabling project managers to understand service area coverage and identify gaps.
Output: New `/mss/dashboard` page with coverage metrics, grouped work item counts, and effort summaries by L2/L3 service hierarchy.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context (MSS foundation):
@.planning/phases/13-mss-data-model/13-01-SUMMARY.md
@.planning/phases/15-mss-mapping-to-work-items/15-01-SUMMARY.md
@.planning/phases/15-mss-mapping-to-work-items/15-02-SUMMARY.md

# Key source files:
@prisma/schema.prisma
@server/actions/mss.ts
@lib/mss/types.ts
@components/mss/mss-stats-card.tsx
@app/mss/page.tsx
@components/layout/sidebar.tsx

**Tech stack available:** Next.js App Router, Prisma, shadcn/ui, Lucide icons
**Established patterns:** Server actions with `{ success: true/false }` returns, MssStatsCard for stats display
**Constraining decisions:**
- Phase 13: MSS schema uses L2 (ServiceLine) → L3 (ServiceArea) → L4 (Activity) hierarchy
- Phase 15: Epics/Stories link to L3 (mssServiceAreaId FK), stories inherit from epic but can override
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MSS Coverage Types and Server Actions</name>
  <files>lib/mss/types.ts, server/actions/mss.ts</files>
  <action>
1. Add coverage types to `lib/mss/types.ts`:
   - `MssCoverageStats`: Overall coverage metrics (total epics, stories, assigned vs unassigned counts, coverage percentages)
   - `MssServiceLineCoverage`: Per-L2 stats (epic count, story count, effort sum if numeric)
   - `MssServiceAreaCoverage`: Per-L3 stats (epic count, story count, epic titles for drill-down)

2. Add server actions to `server/actions/mss.ts`:
   - `getMssCoverageStats()`: Returns overall coverage metrics using Prisma count queries
     - Count total epics, epics with mssServiceAreaId, epics without
     - Count total stories, stories with mssServiceAreaId (direct or inherited), stories without
     - Calculate coverage percentages
   - `getMssCoverageByServiceLine()`: Returns array of L2 service lines with aggregated counts
     - Group epics by mssServiceArea.serviceLine
     - Include nested L3 breakdown with epic/story counts
     - Use Prisma groupBy or raw aggregation as needed

Note: For effort aggregation, parse effort field (handle "S/M/L" vs numeric story points). If mixed formats, count items rather than sum.
  </action>
  <verify>
- `npm run build` passes without TypeScript errors
- New types exported from lib/mss/types.ts
- Server actions return valid data structure when called
  </verify>
  <done>
- MssCoverageStats, MssServiceLineCoverage, MssServiceAreaCoverage types defined
- getMssCoverageStats returns { totalEpics, assignedEpics, unassignedEpics, coveragePercent, ... }
- getMssCoverageByServiceLine returns array with L2→L3 breakdown and counts
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Dashboard Page and Components</name>
  <files>app/mss/dashboard/page.tsx, components/mss/mss-coverage-card.tsx, components/mss/mss-service-line-coverage.tsx, app/mss/page.tsx</files>
  <action>
1. Create `app/mss/dashboard/page.tsx`:
   - Server component that fetches coverage data
   - Use PageHeader with title "MSS Dashboard" and description
   - Layout: Coverage summary cards at top, then service line breakdown below

2. Create `components/mss/mss-coverage-card.tsx`:
   - Display overall coverage metrics in a card grid
   - Show: Total epics, Assigned epics, Coverage %, Total stories, Assigned stories
   - Use similar pattern to MssStatsCard (StatItem with icons)
   - Color-code coverage % (green >80%, yellow 50-80%, red <50%)

3. Create `components/mss/mss-service-line-coverage.tsx`:
   - Collapsible accordion or card list showing L2 service lines
   - Each L2 shows: name, total epic/story count, expandable L3 details
   - L3 items show epic count, story count
   - Use existing shadcn/ui Accordion or Collapsible component
   - Empty state if no MSS data or no assignments

4. Update `app/mss/page.tsx`:
   - Add a "View Dashboard" button/link in the header actions that navigates to /mss/dashboard
   - Use Button with BarChart3 icon from lucide-react

5. Update sidebar navigation (optional enhancement):
   - The /mss route isn't in sidebar currently - this is fine, accessed from header
  </action>
  <verify>
- `npm run build` passes
- Navigate to /mss/dashboard shows page without errors
- Coverage cards display numeric values
- Service line breakdown renders (even if empty state)
  </verify>
  <done>
- /mss/dashboard page renders with coverage data
- MssCoverageCard shows overall metrics with color-coded coverage %
- MssServiceLineCoverage shows L2→L3 hierarchy with counts
- /mss page has link to dashboard
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>MSS Dashboard page with coverage metrics and service line breakdown</what-built>
  <how-to-verify>
    1. Run: `npm run dev` (or use Vercel deployment)
    2. Navigate to /mss page
    3. Click "View Dashboard" button to go to /mss/dashboard
    4. Verify coverage cards show:
       - Total epic count matches actual epics
       - Assigned/unassigned breakdown is correct
       - Coverage percentage displays with appropriate color
    5. Verify service line breakdown shows:
       - L2 service lines that have assigned epics/stories
       - Expandable L3 details with counts
       - Counts match what you see in epics/stories pages
    6. Test with project that has MSS assignments on epics
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] /mss/dashboard page loads without console errors
- [ ] Coverage metrics match actual database counts
- [ ] Service line breakdown displays L2→L3 hierarchy correctly
- [ ] Empty state handles case with no MSS data gracefully
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors introduced
- Dashboard displays accurate coverage metrics
- Service line grouping reflects actual epic/story MSS assignments
- Phase 16 complete
</success_criteria>

<output>
After completion, create `.planning/phases/16-mss-dashboard-reporting/16-01-SUMMARY.md`:

# Phase 16 Plan 01: MSS Dashboard & Reporting Summary

**[One-liner describing what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

Phase 16 complete, ready for Phase 17: MSS Export Integration
</output>
